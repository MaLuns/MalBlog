<!DOCTYPE html><html lang="zh-cn"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="x5-fullscreen" content="true"><meta name="full-screen" content="yes"><meta name="theme-color" content="#317EFB"><meta content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=0" name="viewport"><meta name="keywords" content=",C#,.Net,JavaScript,HTML,CSS"><meta name="description" content="在项目中,一般我们经常会基于一套现有组件库进行快速开发,但是现实中往往需要对组件库进行定制化改造二次封装"><meta property="og:type" content="article"><meta property="og:title" content="Vue 中的 mixin,component,render,hoc"><meta property="og:url" content="https://www.imalun.com/vue_hoc/index.html"><meta property="og:site_name" content="白云苍狗"><meta property="og:description" content="在项目中,一般我们经常会基于一套现有组件库进行快速开发,但是现实中往往需要对组件库进行定制化改造二次封装"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2021-03-02T20:26:25.000Z"><meta property="article:modified_time" content="2021-07-16T05:23:20.737Z"><meta property="article:author" content="白云苍狗"><meta property="article:tag" content="vue"><meta name="twitter:card" content="summary"><meta name="description" content="学习.Net,前端时长三年的,程序猿"><title>白云苍狗 - Vue 中的 mixin,component,render,hoc</title><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png?v=0.2.10"><link rel="manifest" href="/manifest.json"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="canonical" href="https://www.imalun.com/vue_hoc/"><link rel="stylesheet" href="//at.alicdn.com/t/font_1518765_5jbj7btfht2.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/MoePlayer/APlayer@1.10.1/dist/APlayer.min.css"><link rel="stylesheet" href="/css/index.css?v=0.2.10.css"><script type="text/javascript">~function () {
            let setting = localStorage.getItem('setting') ? JSON.parse(localStorage.getItem('setting')) : {};
            let root = document.documentElement;
            for (let key in setting) {
                if (key === 'lightSwitch') {
                    root.classList[setting[key] ? 'add' : 'remove']('dark')
                } else if(key === 'themeColorPicker'){

                } else {
                    setting[key].css.forEach(item => { root.style.setProperty(item.key, item.val); })
                }
            }
        }();</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="白云苍狗" type="application/atom+xml"></head><body><div class="page-img-bg"></div><header class="layout-header"><button type="button" class="header-menu-btn"><i class="iconfont cg-toggle"></i></button><nav class="nav"><li><a data-pjax class="_pjax" href="/">白云苍狗</a></li><li><a data-pjax class="_pjax" href="/archives"><i class="iconfont cg-shijian"></i> 归档</a></li><li><a data-pjax class="_pjax" href="/links"><i class="iconfont cg-links"></i> 友情链接</a></li></nav></header><div class="layout-content"><header class="layout-content-header"><div class="shape"><span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span></div><div class="banner" data-text="白云苍狗" data-interval="100"><div class="title-inner">白云苍狗</div><div class="user-des"><span style="width:55em;animation:typing 10s steps(55),caret .5s steps(1) infinite">「一觉游仙好梦，任它竹冷松寒。轩辕事，古今谈，风流河山。沉醉负白首，舒怀成大观。醒，亦在人间；梦，亦在人间」</span></div></div></header><div class="layout-content-content"><aside id="layout-content-aside" class="layout-content-aside"><div class="aside-nav-card shadow"><header><h2>白云苍狗</h2><p>亦在人间</p></header><ul><a href="/" class="_pjax"><li><svg class="cg-icon" aria-hidden="true"><use xlink:href="#cg-home"></use></svg> 首页</li></a><a href="/links" class="_pjax"><li><svg class="cg-icon" aria-hidden="true"><use xlink:href="#cg-links"></use></svg> 友情链接</li></a><a href="/comment" class="_pjax"><li><svg class="cg-icon" aria-hidden="true"><use xlink:href="#cg-comment"></use></svg> 留言</li></a><a href="/atom.xml" class="_pjax"><li><svg class="cg-icon" aria-hidden="true"><use xlink:href="#cg-rss"></use></svg> RSS</li></a><a href="//github.com/MaLuns" target="_blank" rel="noopener" class="_pjax"><li><svg class="cg-icon" aria-hidden="true"><use xlink:href="#cg-github"></use></svg> Github</li></a><a href="//gitee.com/ml13" target="_blank" rel="noopener" class="_pjax"><li><svg class="cg-icon" aria-hidden="true"><use xlink:href="#cg-gitee"></use></svg> Gitee</li></a><a href="tencent://message/?uin=384399021&amp;Site=有事Q我&amp;Menu=yes"><li><svg class="cg-icon" aria-hidden="true"><use xlink:href="#cg-qq"></use></svg> 联系我</li></a></ul></div><div class="user-card shadow"><img src="/images/avatar.jpg" alt="" class="avatar"><div><p style="margin:20px">醒，亦在人间；梦，亦在人间</p><div class="post-state"><div><span class="item-count">24 </span><span>文章</span></div><div><span class="item-count">3 </span><span>分类</span></div><div><span class="item-count">21 </span><span>标签</span></div></div></div><div id="post-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#混入-mixin"><span class="toc-number">1.</span> <span class="toc-text">混入(mixin)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组件封装"><span class="toc-number">2.</span> <span class="toc-text">组件封装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#template封装"><span class="toc-number">2.1.</span> <span class="toc-text">template封装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#render-函数"><span class="toc-number">2.2.</span> <span class="toc-text">render 函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hoc-高阶组件"><span class="toc-number">3.</span> <span class="toc-text">hoc 高阶组件</span></a></li></ol></div></div></aside><div id="sidebar-mask"></div><main id="main" class="layout-content-main"><article class="shadow animated fadeInUp"><header class="post-header"><div class="post-container"><h2 class="post-title">「Vue 中的 mixin,component,render,hoc」</h2><div class="post-meta"><div><span class="post-push-time"><time datetime="2021-03-02T20:26:25.000Z" title="2021-03-02T20:26:25.000Z" itemprop="datePublished"><i class="iconfont cg-shijian"></i> 2021-03-02 </time><span class="post-meta-divider">•</span> </span><span><i class="iconfont cg-tag1"></i> 记录类 <span class="post-meta-divider">•</span> </span><span><i class="iconfont cg-tag1"></i> <a class="_pjax" href="/categories/记录类">记录类</a></span></div><span class="post-wordcount"><span class="post-meta-item-text"><i class="iconfont cg-wendang"></i> 共2.6k字 </span><span class="post-meta-divider">•</span> </span><span class="post-consuming-time"><span class="post-meta-item-text"><i class="iconfont cg-shalou"></i> 约13分钟</span></span></div></div></header><div id="nice" class="post-content post-content-detail"><p>在项目中,一般我们经常会基于一套现有组件库进行快速开发,但是现实中往往需要对组件库进行定制化改造二次封装</p><a id="more"></a><h2 id="混入-mixin"><a href="#混入-mixin" class="headerlink" title="混入(mixin)"></a>混入(mixin)</h2><p>vue 官方介绍</p><blockquote><p>混入 (mixin) 提供了一种非常灵活的方式，来分发 Vue 组件中的可复用功能。一个混入对象可以包含任意组件选项。当组件使用混入对象时，所有混入对象的选项将被“混合”进入该组件本身的选项。</p></blockquote><p>简单来说就是将组件的对象的属性,方法,钩子函数等等进行提取封装,以便达到可以多出复用。来看一个简单例子</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:v-loading</span>=<span class="string">'isLoading'</span> <span class="attr">:data</span>=<span class="string">"tableData"</span> <span class="attr">style</span>=<span class="string">"width: 100%"</span>  <span class="attr">ref</span>=<span class="string">"table"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">"selection"</span> <span class="attr">width</span>=<span class="string">"55"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"name"</span> <span class="attr">label</span>=<span class="string">"规则名称"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"description"</span> <span class="attr">label</span>=<span class="string">"描述"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"count"</span> <span class="attr">label</span>=<span class="string">"服务调用次数(万)"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"state"</span> <span class="attr">label</span>=<span class="string">"状态"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"&#123;row&#125;"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">:class</span>=<span class="string">"['run-state',row.state]"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#123;&#123; row.state=='close'?'关闭':'运行中' &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"time"</span> <span class="attr">label</span>=<span class="string">"上次调度时间"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">"操作"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-divider</span> <span class="attr">direction</span>=<span class="string">"vertical"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-divider</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span>订阅警报<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">el-pagination</span> <span class="attr">:current-page.sync</span>=<span class="string">"page.pageIndex"</span> <span class="attr">:page-sizes</span>=<span class="string">"[20, 30, 40, 50]"</span> @<span class="attr">size-change</span>=<span class="string">"(e)=&gt;page.pageSize=e"</span> <span class="attr">:total</span>=<span class="string">"total"</span> <span class="attr">layout</span>=<span class="string">"total, sizes, prev, pager, next, jumper"</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">    data () &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line">            tableData:[],</span><br><span class="line"><span class="actionscript">            isLoading: <span class="literal">false</span>,</span></span><br><span class="line">            total: 0,</span><br><span class="line">            page: &#123;</span><br><span class="line">                pageSize: 20,</span><br><span class="line">                pageIndex: 1</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line"><span class="actionscript">        <span class="string">'page'</span>:&#123;</span></span><br><span class="line"><span class="actionscript">            deep: <span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">            immediate: <span class="literal">true</span>,</span></span><br><span class="line">            handler()&#123;</span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.getList()</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line"><span class="actionscript">        getList(pageIndex = <span class="keyword">this</span>.page.pageIndex,pageSize = <span class="keyword">this</span>.page.pageSize)&#123;</span></span><br><span class="line"><span class="actionscript">            <span class="comment">//获取列表数据</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.isLoading = <span class="literal">true</span>;</span></span><br><span class="line"><span class="javascript">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.tableData = MockData();</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.total=<span class="number">300</span>;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.isLoading = <span class="literal">false</span>;</span></span><br><span class="line">            &#125;, 2000);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面是个常见报表分页使用场景,假如有很多个表报,那就需要写很多次分页的逻辑,正常开发中当然不可能这么处理的, 这种情况就可以使用mixins来提取分页的逻辑</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// mixins.js</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    data () &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            isLoading: <span class="literal">false</span>,</span><br><span class="line">            total: <span class="number">0</span>,</span><br><span class="line">            page: &#123;</span><br><span class="line">                pageSize: <span class="number">20</span>,</span><br><span class="line">                pageIndex: <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">        <span class="string">'page'</span>:&#123;</span><br><span class="line">            deep: <span class="literal">true</span>,</span><br><span class="line">            immediate: <span class="literal">true</span>,</span><br><span class="line">            handler()&#123;</span><br><span class="line">                <span class="keyword">this</span>.getList()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:v-loading</span>=<span class="string">'isLoading'</span> <span class="attr">:data</span>=<span class="string">"tableData"</span> <span class="attr">style</span>=<span class="string">"width: 100%"</span>  <span class="attr">ref</span>=<span class="string">"table"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">"selection"</span> <span class="attr">width</span>=<span class="string">"55"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"name"</span> <span class="attr">label</span>=<span class="string">"规则名称"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"description"</span> <span class="attr">label</span>=<span class="string">"描述"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"count"</span> <span class="attr">label</span>=<span class="string">"服务调用次数(万)"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"state"</span> <span class="attr">label</span>=<span class="string">"状态"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"&#123;row&#125;"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">:class</span>=<span class="string">"['run-state',row.state]"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#123;&#123; row.state=='close'?'关闭':'运行中' &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"time"</span> <span class="attr">label</span>=<span class="string">"上次调度时间"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">"操作"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-divider</span> <span class="attr">direction</span>=<span class="string">"vertical"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-divider</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span>订阅警报<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">el-pagination</span> <span class="attr">:current-page.sync</span>=<span class="string">"page.pageIndex"</span> <span class="attr">:page-sizes</span>=<span class="string">"[20, 30, 40, 50]"</span> @<span class="attr">size-change</span>=<span class="string">"(e)=&gt;page.pageSize=e"</span> <span class="attr">:total</span>=<span class="string">"page.total"</span> <span class="attr">layout</span>=<span class="string">"total, sizes, prev, pager, next, jumper"</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> PageMixins <span class="keyword">from</span> <span class="string">"./mixins.js"</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">    mixins:[PageMixins],</span><br><span class="line">    data () &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line">            tableData:[]</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line"><span class="actionscript">        getList(pageIndex = <span class="keyword">this</span>.page.pageIndex,pageSize = <span class="keyword">this</span>.page.pageSize)&#123;</span></span><br><span class="line"><span class="actionscript">            <span class="comment">//获取列表数据</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.isLoading = <span class="literal">true</span>;</span></span><br><span class="line"><span class="javascript">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.tableData = MockData();</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.total=<span class="number">300</span>;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.isLoading = <span class="literal">false</span>;</span></span><br><span class="line">            &#125;, 2000);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这样就将分页的逻辑分离出来了,也可以被其他组件混入使用,大大的减少了代码量,当然mixin过度滥用也是存在缺点的</p><ul><li>命名冲突<br>使用mixins是将两个组件对象合并的,当两个组件属性名重复时候,vue默认会将本地组件的属性覆盖mixin的,虽然vue提供了合并策略配置,但是同时存在多个mixin存在命名冲突时候就会变得处理起来非常麻烦了</li><li>隐含的依赖关系<br>很明显上面的组件是依赖于mixin的,这种情况会存在潜在问题。如果我们以后想重构一个组件，改变了mixin需要的变量的名称，就会影响现有的组件的使用了,而且当项目中使用了很多这个mixin的时候,就只能去手动搜索修改了。因为不知道哪些组件使用了这些mixin</li></ul><h2 id="组件封装"><a href="#组件封装" class="headerlink" title="组件封装"></a>组件封装</h2><p>上面表格还有中处理方法,就是将el-table和el-pagination封装成一个组件去是使用,也能提高复用性</p><h3 id="template封装"><a href="#template封装" class="headerlink" title="template封装"></a>template封装</h3><p>使用template创建组件,来对el-table进行二次封装满足上面需求,增加一个total参数<br>提供是一个分页改变事件,再把m-table的$attrs和$listeners 绑定到el-table上,然后把el-table 方法暴露出去,这样就可像使用 el-table 一样使用 m-table</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">ref</span>=<span class="string">"table"</span> <span class="attr">v-bind</span>=<span class="string">"$attrs"</span> <span class="attr">v-on</span>=<span class="string">"$listeners"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-pagination</span> <span class="attr">:current-page.sync</span>=<span class="string">"page.pageIndex"</span> <span class="attr">:page-sizes</span>=<span class="string">"[20, 30, 40, 50]"</span> @<span class="attr">size-change</span>=<span class="string">"(e)=&gt;page.pageSize=e"</span> <span class="attr">:total</span>=<span class="string">"total"</span> <span class="attr">layout</span>=<span class="string">"total, sizes, prev, pager, next, jumper"</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">    name: <span class="string">'m-table'</span>,</span></span><br><span class="line">    data() &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line">            page: &#123;</span><br><span class="line">                pageSize: 20,</span><br><span class="line">                pageIndex: 2</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    props: &#123;</span><br><span class="line">        total: &#123;</span><br><span class="line"><span class="javascript">            type: <span class="built_in">Number</span>,</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">default</span>: <span class="number">0</span></span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">        page: &#123;</span><br><span class="line"><span class="actionscript">            deep: <span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">            handler: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$emit(<span class="string">"page-chagne"</span>)</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line"><span class="actionscript">        <span class="comment">// 将el-table 方法暴露出去</span></span></span><br><span class="line"><span class="javascript">        ...(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">let</span> methodsJson = &#123;&#125;;</span></span><br><span class="line"><span class="actionscript">            [<span class="string">'reloadData'</span>, <span class="string">'clearSelection'</span>, <span class="string">'toggleRowSelection'</span>, <span class="string">'toggleAllSelection'</span>, <span class="string">'setCurrentRow'</span>, <span class="string">'clearSort'</span>, <span class="string">'clearFilter'</span>, <span class="string">'doLayout'</span>, <span class="string">'sort'</span>]</span></span><br><span class="line"><span class="javascript">                .forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span></span><br><span class="line">                    methodsJson = &#123;</span><br><span class="line">                        ...methodsJson, [key](...res) &#123;</span><br><span class="line"><span class="actionscript">                            <span class="keyword">this</span>.$refs[<span class="string">'table'</span>][key].apply(<span class="keyword">this</span>, res);</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;);</span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span> methodsJson;</span></span><br><span class="line">        &#125;)()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>使用 m-table</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">m-table</span> @<span class="attr">page-chagne</span>=<span class="string">"GetTableDataList()"</span> <span class="attr">:total</span>=<span class="string">"page.total"</span> <span class="attr">:data</span>=<span class="string">"tableData"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">"selection"</span> <span class="attr">width</span>=<span class="string">"55"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"name"</span> <span class="attr">label</span>=<span class="string">"规则名称"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"description"</span> <span class="attr">label</span>=<span class="string">"描述"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"count"</span> <span class="attr">label</span>=<span class="string">"服务调用次数(万)"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"state"</span> <span class="attr">label</span>=<span class="string">"状态"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"&#123;row&#125;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">:class</span>=<span class="string">"['run-state',row.state]"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            &#123;&#123; row.state=='close'?'关闭':'运行中' &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"time"</span> <span class="attr">label</span>=<span class="string">"上次调度时间"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">"操作"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-divider</span> <span class="attr">direction</span>=<span class="string">"vertical"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-divider</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span>订阅警报<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">m-table</span>&gt;</span></span><br></pre></td></tr></table></figure><p>一般情况下这样使用 template 封装就满足了需求,但是总有些时候这样封装是满足不了需求的。比如现在m-table现在需要动态支持修改配置显示列,并且不希望修改m-table的基本使用方式, 这个时候就需要使用 render 了。</p><h3 id="render-函数"><a href="#render-函数" class="headerlink" title="render 函数"></a>render 函数</h3><p>Vue 的模板实际上都会被编译成了渲染函数,render 函数有一个 createElement 参数,用来创建一个VNode。</p><p>要满足上面的需求,首先是的获得el-table的插槽(slot)中的内容,根据插槽的内容生成每列信息,根据配置的信息动态创建插槽的内容就可以实现了。简单示例代码入下</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> mSetting <span class="keyword">from</span> <span class="string">'./setting'</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">    components: &#123; mSetting &#125;,</span><br><span class="line"><span class="actionscript">    name: <span class="string">'m-table'</span>,</span></span><br><span class="line">    data() &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">            showTable: <span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">            setShow: <span class="literal">false</span>,</span></span><br><span class="line">            config: [],</span><br><span class="line"><span class="actionscript">            copySlots: [], <span class="comment">// 展示solt数据</span></span></span><br><span class="line">            page: &#123;</span><br><span class="line">                pageSize: 20,</span><br><span class="line">                pageIndex: 1</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    props: &#123;</span><br><span class="line">        total: &#123;</span><br><span class="line"><span class="javascript">            type: <span class="built_in">Number</span>,</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">default</span>: <span class="number">0</span></span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">        page: &#123;</span><br><span class="line"><span class="actionscript">            deep: <span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">            handler: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$emit(<span class="string">"page-chagne"</span>)</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created() &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.initConfig()</span></span><br><span class="line">    &#125;,</span><br><span class="line">    render() &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> (</span></span><br><span class="line"><span class="handlebars"><span class="xml">            <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="actionscript">                &lt;el-table ref=<span class="string">"table"</span> &#123;...&#123; attrs: <span class="keyword">this</span>.$attrs &#125;&#125; &#123;...&#123; on: <span class="keyword">this</span>.$listeners &#125;&#125;&gt;</span></span><br><span class="line">                    &#123;</span><br><span class="line"><span class="actionscript">                        <span class="keyword">this</span>.copySlots</span></span><br><span class="line">                    &#125;</span><br><span class="line"><span class="handlebars"><span class="xml">                <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span></span></span><br><span class="line"><span class="actionscript">                &#123;<span class="keyword">this</span>.showTable ? (&lt;el-pagination layout=<span class="string">"total, sizes, prev, pager, next, jumper"</span></span></span><br><span class="line">                    &#123;...&#123;</span><br><span class="line">                        on: &#123;</span><br><span class="line"><span class="javascript">                            <span class="string">'size-change'</span>: <span class="function">(<span class="params">e</span>) =&gt;</span> <span class="keyword">this</span>.page.pageSize = e,</span></span><br><span class="line"><span class="javascript">                            <span class="string">'current-change'</span>: <span class="function">(<span class="params">e</span>) =&gt;</span> <span class="keyword">this</span>.page.pageIndex = e</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;&#125;</span><br><span class="line">                    &#123;...&#123;</span><br><span class="line">                        attrs: &#123;</span><br><span class="line"><span class="actionscript">                            <span class="string">'current-page'</span>: <span class="keyword">this</span>.page.pageIndex,</span></span><br><span class="line"><span class="actionscript">                            <span class="string">'page-sizes'</span>: [<span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>],</span></span><br><span class="line"><span class="actionscript">                            <span class="string">'total'</span>: <span class="keyword">this</span>.total</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;&#125;</span><br><span class="line"><span class="javascript">                &gt; <span class="xml"><span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span>) : <span class="literal">null</span>&#125;</span></span><br><span class="line">                &lt;m-setting  &#123;...&#123;</span><br><span class="line">                    on: &#123;</span><br><span class="line"><span class="javascript">                        <span class="string">'update:show'</span>: <span class="function"><span class="params">e</span> =&gt;</span> <span class="keyword">this</span>.setShow = e,</span></span><br><span class="line"><span class="actionscript">                        <span class="string">'change'</span>: <span class="keyword">this</span>.initConfig</span></span><br><span class="line">                    &#125;</span><br><span class="line"><span class="javascript">                &#125;&#125; show=&#123;<span class="keyword">this</span>.setShow&#125; config=&#123;<span class="keyword">this</span>.config&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">m-setting</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">            <span class="tag">&lt;/<span class="name">div</span> &gt;</span></span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        initConfig(config = []) &#123;</span><br><span class="line">            if (config.length === 0) &#123;</span><br><span class="line"><span class="actionscript">                config = <span class="keyword">this</span>.$slots.default</span></span><br><span class="line"><span class="javascript">                    .filter(<span class="function"><span class="params">item</span> =&gt;</span> item.componentOptions &amp;&amp; item.componentOptions.tag === <span class="string">"el-table-column"</span>)</span></span><br><span class="line"><span class="javascript">                    .map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                        <span class="keyword">if</span> (item.componentOptions.propsData.prop === <span class="string">'index'</span>) &#123;</span></span><br><span class="line">                            if (!item.data.scopedSlots) &#123;</span><br><span class="line">                                item.data.scopedSlots = &#123;&#125;;</span><br><span class="line">                            &#125;</span><br><span class="line"><span class="javascript">                            item.data.scopedSlots.header = <span class="function"><span class="params">()</span> =&gt;</span> (</span></span><br><span class="line"><span class="javascript">                                &lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"el-icon-s-tools"</span> onClick=&#123;() =&gt; <span class="keyword">this</span>.setShow = <span class="literal">true</span>&#125; /&gt;</span></span><br><span class="line">                            );</span><br><span class="line">                        &#125;</span><br><span class="line"><span class="actionscript">                        <span class="keyword">return</span> &#123; ...item.componentOptions.propsData &#125;;</span></span><br><span class="line">                    &#125;)</span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.sourceConfig = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(config))</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.copySlots = <span class="keyword">this</span>.$slots.default;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.sourceSlots = <span class="keyword">this</span>.$slots.default;</span></span><br><span class="line"><span class="actionscript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">let</span> arr = []</span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.sourceSlots.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">let</span> temp = config.find(<span class="function"><span class="params">subItem</span> =&gt;</span></span></span><br><span class="line">                        (subItem.prop &amp;&amp; subItem.prop === item.componentOptions.propsData.prop) ||</span><br><span class="line">                        (subItem.type &amp;&amp; subItem.type === item.componentOptions.propsData.type)</span><br><span class="line">                    );</span><br><span class="line">                    if (temp &amp;&amp; temp.isShow) &#123;</span><br><span class="line"><span class="javascript">                        <span class="built_in">Object</span>.assign(item.componentOptions.propsData, temp);</span></span><br><span class="line">                        arr.push(item)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.copySlots = arr;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.showTable = <span class="literal">false</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">this</span>.showTable = <span class="literal">true</span></span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.config = config;</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="javascript">        ...(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">let</span> methodsJson = &#123;&#125;;</span></span><br><span class="line"><span class="actionscript">            [<span class="string">'reloadData'</span>, <span class="string">'clearSelection'</span>, <span class="string">'toggleRowSelection'</span>, <span class="string">'toggleAllSelection'</span>, <span class="string">'setCurrentRow'</span>, <span class="string">'clearSort'</span>, <span class="string">'clearFilter'</span>, <span class="string">'doLayout'</span>, <span class="string">'sort'</span>]</span></span><br><span class="line"><span class="javascript">                .forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span></span><br><span class="line">                    methodsJson = &#123;</span><br><span class="line">                        ...methodsJson, [key](...res) &#123;</span><br><span class="line"><span class="actionscript">                            <span class="keyword">this</span>.$refs[<span class="string">'table'</span>][key].apply(<span class="keyword">this</span>, res);</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;);</span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span> methodsJson;</span></span><br><span class="line">        &#125;)()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">title</span>=<span class="string">"表格设置"</span> <span class="attr">:visible.sync</span>=<span class="string">"shows"</span> <span class="attr">width</span>=<span class="string">"600px"</span> <span class="attr">size</span>=<span class="string">"small"</span> <span class="attr">:before-close</span>=<span class="string">"handleClose"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">"list"</span> <span class="attr">size</span>=<span class="string">'mini'</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"showLabel"</span> <span class="attr">label</span>=<span class="string">"名称"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"label"</span> <span class="attr">label</span>=<span class="string">"显示名称"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"&#123;row&#125;"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">size</span>=<span class="string">"mini"</span> <span class="attr">v-model</span>=<span class="string">"row.label"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"isShow"</span> <span class="attr">label</span>=<span class="string">"是否显示"</span> <span class="attr">width</span>=<span class="string">"100"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"&#123;row&#125;"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-switch</span> <span class="attr">v-model</span>=<span class="string">"row.isShow"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-switch</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">"footer"</span> <span class="attr">class</span>=<span class="string">"dialog-footer"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">"shows = false"</span> <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span>取 消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"handleClose()"</span> <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span>确 定<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">    name: <span class="string">'m-setting'</span>,</span></span><br><span class="line">    data() &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line">            list: []</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    computed: &#123;</span><br><span class="line">        shows: &#123;</span><br><span class="line"><span class="javascript">            <span class="keyword">get</span>() &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">return</span> <span class="keyword">this</span>.show;</span></span><br><span class="line">            &#125;,</span><br><span class="line"><span class="javascript">            <span class="keyword">set</span>() &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$emit(<span class="string">"update:show"</span>)</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    props: &#123;</span><br><span class="line">        show: &#123;</span><br><span class="line"><span class="javascript">            type: <span class="built_in">Boolean</span>,</span></span><br><span class="line"><span class="actionscript">            required: <span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">default</span>: <span class="literal">false</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        config: &#123;</span><br><span class="line"><span class="javascript">            type: <span class="built_in">Array</span>,</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">default</span>() &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">return</span> []</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created() &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.init()</span></span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        init() &#123;</span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.list = <span class="keyword">this</span>.config.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">return</span> &#123;</span></span><br><span class="line">                    ...item,</span><br><span class="line"><span class="actionscript">                    showLabel: item.showLabel || item.label, <span class="comment">// 名称</span></span></span><br><span class="line"><span class="actionscript">                    isShow: item.isShow || <span class="literal">true</span> <span class="comment">// 是否显示</span></span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,</span><br><span class="line">        handleClose() &#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.$emit(<span class="string">'change'</span>, <span class="keyword">this</span>.list);</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.shows = <span class="literal">false</span></span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这样就简单实现了可以动态显示列,而且不需要去修改原组件的使用方式了</p><h2 id="hoc-高阶组件"><a href="#hoc-高阶组件" class="headerlink" title="hoc 高阶组件"></a>hoc 高阶组件</h2><p><a href="http://hcysun.me/2018/01/05/%E6%8E%A2%E7%B4%A2Vue%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/" target="_blank" rel="noopener">vue高阶组件可以参考这篇</a></p><div class="post-content-tag"><svg class="cg-icon" aria-hidden="true"><use xlink:href="#cg-tag"></use></svg> <a class="_pjax" href="/tags/vue"><span>vue</span></a></div></div></article><div id="share_container"><div></div><div></div><div></div><div></div></div><div class="prev-next-content"><div class="btn-prev"><div><i class="iconfont cg-shangyige"></i> 上一篇</div><a class="_pjax" href="/mongodb_sql/">MongoDB基础篇（一）</a></div><div class="btn-next"><div>下一篇 <i class="iconfont cg-xiayige"></i></div><a class="_pjax" href="/vue_event_listener/">记一次在Vue中使用 addEventListener 的坑</a></div></div></main></div></div><footer class="layout-footer"><div>© 2019 - <span itemprop="copyrightYear">2021</span> 白云苍狗.</div><div>由<a> Hexo </a>强力驱动; Theme by <a href="//github.com/MaLuns/MalBlog/tree/master/themes/hexo-theme-simple" target="_blank">hexo-theme-simple </a>;</div><div>博客已萌萌哒运行: <span id="since"></span> <span class="my-face">(●'◡'●)ﾉ♥</span></div></footer><div id="aplayer-fixed"></div><script type="text/javascript">function show_date_time(){window.setTimeout("show_date_time()",1e3),BirthDay=new Date("11/19/2019 17:00:00"),today=new Date,timeold=today.getTime()-BirthDay.getTime(),sectimeold=timeold/1e3,secondsold=Math.floor(sectimeold),msPerDay=864e5,e_daysold=timeold/msPerDay,daysold=Math.floor(e_daysold),e_hrsold=24*(e_daysold-daysold),hrsold=Math.floor(e_hrsold),e_minsold=60*(e_hrsold-hrsold),minsold=Math.floor(60*(e_hrsold-hrsold)),seconds=Math.floor(60*(e_minsold-minsold)),since.innerHTML=daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒"}show_date_time()</script><div class="float-action-buttons"><com-tips dir="left" tips="回到顶部" style="display:block" class="backtop"><button type="button" class="btn shadow" id="back-top"><i class="iconfont cg-backtop"></i></button></com-tips><com-tips dir="left" tips="昼夜切换" style="display:block"><button type="button" class="btn shadow" id="lightBtn"><i class="iconfont cg-rijian"></i> <i class="iconfont cg-zhanghu-heiye"></i></button></com-tips><com-popover><com-tips dir="left" tips="设置"><button type="button" class="btn shadow" id="setbtn"><i class="iconfont cg-shezhi"></i></button></com-tips><com-popcon u-none><div id="settingsPopup" class="shadow"><div class="settings-item"><div class="settings-item-lable">夜间模式</div><com-switch id="lightSwitch"></com-switch></div><div class="settings-item"><div class="settings-item-lable">字体</div><com-radio-group id="fontFamily" defaultvalue="sans-serif"><com-radio value="sans-serif">sans-serif</com-radio><com-radio value="serif">serif</com-radio></com-radio-group></div><div class="settings-item"><div class="settings-item-lable">阴影</div><com-radio-group id="boxShadowBlur" defaultvalue="5"><com-radio value="0">无</com-radio><com-radio value="5">浅</com-radio><com-radio value="15">深</com-radio></com-radio-group></div><div class="settings-item"><div class="settings-item-lable">滤镜</div><com-radio-group id="filterColor" defaultvalue="none"><com-radio value="none">关闭</com-radio><com-radio value="sunset">日落</com-radio><com-radio value="sunrise">日出</com-radio></com-radio-group></div><div class="settings-item"><div class="settings-item-lable">圆角</div><com-slider id="radiusSlider" showtips suffix="px" min="0" max="20"></com-slider></div></div></com-popcon></com-popover><com-tips dir="left" tips="菜单" class="aside-menu"><button type="button" class="btn shadow" id="asideMenu"><i class="iconfont cg-menu"></i></button></com-tips></div><script type="text/javascript">(window.ActiveXObject||"ActiveXObject"in window)&&(document.body.innerHTML="<h2 style='text-align:center; line-height:100px; font-weight:700;'>为了更好的体验,请使用非IE浏览器</h2><footer class='layout-footer'><div>© 2019 - <span itemprop='copyrightYear'>2020</span> 白云苍狗.</div><div>由<a> Hexo </a>强力驱动; Theme by <a href='//github.com/MaLuns/MalBlog/tree/master/themes/hexo-theme-simple' target='_blank'>hexo-theme-simple </a>;</div><div>博客已萌萌哒运行: <span id='since'>379天22小时55分55秒</span> <span class='my-face'>(●'◡'●)ﾉ♥</span></div></footer>");var CONFIG={favicon:{visibilitychange:JSON.parse("true"),narmal:"/images/favicon.png",hidden:"/images/failure.png",show_text:"(/≧▽≦/)咦！又好了！",hide_text:"(●—●)喔哟，崩溃啦！"}}</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/MoePlayer/APlayer@1.10.1/dist/APlayer.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script><script type="text/javascript" src="//at.alicdn.com/t/font_1518765_5jbj7btfht2.js"></script><script type="text/javascript" src="//imgcache.qq.com/qcloud/tcbjs/1.6.0/tcb.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script src="/js/index.min.js?v=0.2.10.js"></script><script>"serviceWorker"in navigator?navigator.serviceWorker.register("/sw.js").then(function(){navigator.serviceWorker.controller?console.log("Assets cached by the controlling service worker."):console.log("Please reload this page to allow the service worker to handle network operations.")}).catch(function(e){console.log("ERROR: "+e)}):console.log("Service workers are not supported in the current browser.")</script></body></html>